{"ast":null,"code":"import _toConsumableArray from\"/Users/francesco/Downloads/ecommerce copia/backend/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import React,{useEffect}from'react';import{Link}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{Row,Col,ListGroup,Image,Form,Button,Card}from'react-bootstrap';import Message from'../components/Message';import{LinkContainer}from'react-router-bootstrap';import{addToCart,removeFromCart}from'../actions/cartActions';import AnimatedPage from'../components/AnimatedPage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CartScreen(_ref){var match=_ref.match,location=_ref.location,history=_ref.history;var productId=match.params.id;//cattura l'ID dall'URL\nvar qty=location.search?Number(location.search.split('=')[1]):1;//prende il valore di qty dall'URL\n//[1] Number colpishe solo il secondo indice quindi 1 altrimenti avrebbe dato errore Nan\nvar dispatch=useDispatch();var userLogin=useSelector(function(state){return state.userLogin;});var userInfo=userLogin.userInfo;var cart=useSelector(function(state){return state.cart;});var pushLogin=function pushLogin(){history.push(\"/register\");};var cartItems=cart.cartItems;/* console.log('cartItems:', cartItems) */useEffect(function(){if(!userInfo){history.push(\"/login\");}if(productId){//con dispatch mando le azioni al reducer\ndispatch(addToCart(productId,qty));}},[dispatch,productId,qty]);var removeFromCartHandler=function removeFromCartHandler(id){dispatch(removeFromCart(id));};var checkoutHandler=function checkoutHandler(){history.push('/login');};return/*#__PURE__*/_jsx(AnimatedPage,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:8,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Shopping Cart\"}),cartItems.length===0?/*#__PURE__*/_jsxs(Message,{variant:\"info\",children:[\"Your cart is empty \",/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Go back\"})]}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:cartItems.map(function(item){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:2,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(Col,{md:2,children:[\"$\",item.price]}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Form.Control,{as:\"select\",value:item.qty,onChange:function onChange(e){return dispatch(addToCart(item.product,parseInt(e.target.value)),history.push('/cart'));},children:_toConsumableArray(Array(item.countInStock).keys()).map(function(x){return/*#__PURE__*/ (//keys ritorna un array con le pk degli oggetti es. [0,1,2]\n_jsx(\"option\",{value:x+1,children:x+1},x+1));})//mappo una serie di tag options in cui è un numero dell'array di countInStock generato con keys()\n})}),/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Button,{type:\"button\",variant:\"light\",onClick:function onClick(){return removeFromCartHandler(item.product,history.push('/cart'));},children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash\"})})})]})},item.product);})})]}),/*#__PURE__*/_jsx(Col,{md:4,className:\"py-5\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Subtotal (\",cartItems.reduce(function(acc,item){return acc+item.qty;},0),\") items\"]}),\"  \",\"$\",cartItems.reduce(function(acc,item){return acc+item.qty*item.price;},0).toFixed(2)]}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(LinkContainer,{to:\"/shipping\",children:/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn-block\",disabled:cartItems==0,children:\"Proceed To Checkout\"})})})]})})})]})});}export default CartScreen;","map":{"version":3,"names":["React","useEffect","Link","useDispatch","useSelector","Row","Col","ListGroup","Image","Form","Button","Card","Message","LinkContainer","addToCart","removeFromCart","AnimatedPage","jsx","_jsx","jsxs","_jsxs","CartScreen","_ref","match","location","history","productId","params","id","qty","search","Number","split","dispatch","userLogin","state","userInfo","cart","pushLogin","push","cartItems","removeFromCartHandler","checkoutHandler","children","md","length","variant","to","map","item","Item","src","image","alt","name","fluid","rounded","concat","product","price","Control","as","value","onChange","e","parseInt","target","_toConsumableArray","Array","countInStock","keys","x","type","onClick","className","reduce","acc","toFixed","disabled"],"sources":["/Users/francesco/Downloads/ecommerce copia/backend/frontend/src/screens/CartScreen.js"],"sourcesContent":["import React, {useEffect} from 'react'\nimport {Link} from 'react-router-dom'\nimport {useDispatch, useSelector} from 'react-redux'\nimport {Row, Col, ListGroup, Image, Form, Button, Card } from 'react-bootstrap'\nimport Message  from '../components/Message'\nimport { LinkContainer } from 'react-router-bootstrap'\nimport {addToCart, removeFromCart} from '../actions/cartActions'\nimport AnimatedPage from '../components/AnimatedPage'\n\n\nfunction CartScreen({ match, location, history }) {\n  const productId = match.params.id //cattura l'ID dall'URL\n  const qty = location.search ? Number(location.search.split('=')[1]): 1 //prende il valore di qty dall'URL\n                                                                          //[1] Number colpishe solo il secondo indice quindi 1 altrimenti avrebbe dato errore Nan\n  const dispatch = useDispatch()\n\n  const userLogin = useSelector(state => state.userLogin) \n    const { userInfo } = userLogin \n\n  const cart = useSelector(state=> state.cart)\n  \n  const pushLogin = () => {\n    history.push(\"/register\")\n  } \n  const { cartItems } = cart\n\n  /* console.log('cartItems:', cartItems) */\n\n\n  useEffect(() =>{\n    if (!userInfo) {\n      history.push(\"/login\")}\n    if(productId){\n      //con dispatch mando le azioni al reducer\n        dispatch(addToCart(productId,qty))\n    }\n  }, [dispatch, productId, qty])\n\n  const removeFromCartHandler = (id) => {\n    dispatch(removeFromCart(id)) \n    \n  }\n\n  const checkoutHandler = () =>{\n    history.push('/login')\n  }\n\n  return (\n  <AnimatedPage>\n    <Row>\n        <Col md={8}>\n            <h1>Shopping Cart</h1>\n            {cartItems.length === 0 ? (\n              <Message variant='info'>Your cart is empty <Link to='/'>Go back</Link></Message>\n            ) : (\n              <ListGroup variant='flush'>\n                  {cartItems.map(item => (\n                    <ListGroup.Item key={item.product}>\n                      <Row>\n                          <Col md={2}>\n                            <Image src={item.image} alt={item.name} fluid rounded></Image>\n                          </Col>\n\n                          <Col md={3}>\n                            <Link to={`/product/${item.product}`} >{item.name}</Link>\n                          </Col>\n\n                          <Col md={2}>\n                            ${item.price}\n                          </Col>\n\n                          <Col md={3}>\n                            <Form.Control\n                                  as=\"select\"\n                                  value={item.qty}\n                                  onChange={(e) => dispatch(addToCart(item.product, parseInt(e.target.value)), history.push('/cart'))}\n                                  >\n                                    {\n                                        [...Array(item.countInStock).keys()].map((x) => ( //keys ritorna un array con le pk degli oggetti es. [0,1,2]\n                                         \n                                         <option key={x + 1} value={x + 1}>\n                                            {x + 1}\n                                         </option>\n\n                        \n                                        ))//mappo una serie di tag options in cui è un numero dell'array di countInStock generato con keys()\n                                    }\n                              </Form.Control>\n                          </Col>\n\n                          <Col md={1}>\n                            <Button type='button' \n                            variant='light'\n                            onClick={() => removeFromCartHandler(item.product, history.push('/cart'))}> \n                                <i className='fas fa-trash'></i>\n                            </Button>\n                          </Col>\n                      </Row>\n                    </ListGroup.Item>\n                  ))}\n              </ListGroup>\n            ) }\n        </Col>\n\n        \n        \n        <Col md={4} className=\"py-5\">\n            <Card>\n              <ListGroup variant='flush'>\n                  <ListGroup.Item>\n                    <h2>Subtotal ({cartItems.reduce((acc, item) => acc + item.qty, 0)}) items</h2>  {/* 0 è il valore di partenza di acc */}\n                      ${cartItems.reduce((acc, item) => acc + item.qty * item.price, 0).toFixed(2)}\n                  </ListGroup.Item>\n\n                  <ListGroup.Item>\n                  <LinkContainer to='/shipping'>\n                    <Button\n                      type='button'\n                      className='btn-block'\n                      disabled={cartItems == 0}\n                    >\n                      Proceed To Checkout \n                    </Button>\n                    </LinkContainer>\n                  </ListGroup.Item>\n              </ListGroup>\n\n            </Card>\n        </Col>\n    </Row>\n    </AnimatedPage>\n  )\n}\n\nexport default CartScreen"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}